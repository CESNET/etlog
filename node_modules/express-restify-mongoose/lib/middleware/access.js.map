{"version":3,"sources":["../../src/middleware/access.js"],"names":[],"mappings":";;AAAA,OAAO,OAAP,GAAiB,UAAU,OAAV,EAAmB;AAClC,MAAM,eAAe,QAAQ,iBAAR,EAA2B,OAA3B,CAArB;;AAEA,SAAO,UAAU,GAAV,EAAe,GAAf,EAAoB,IAApB,EAA0B;AAC/B,QAAM,UAAU,SAAV,OAAU,CAAU,GAAV,EAAe,MAAf,EAAuB;AACrC,UAAI,GAAJ,EAAS;AACP,eAAO,aAAa,GAAb,EAAkB,GAAlB,EAAuB,IAAvB,EAA6B,GAA7B,CAAP;AACD;;AAED,UAAI,CAAC,QAAD,EAAW,SAAX,EAAsB,WAAtB,EAAmC,OAAnC,CAA2C,MAA3C,IAAqD,CAAzD,EAA4D;AAC1D,cAAM,IAAI,KAAJ,CAAU,gEAAV,CAAN;AACD;;AAED,UAAI,MAAJ,GAAa,MAAb;AACA;AACD,KAXD;;AAaA,QAAI,QAAQ,MAAR,CAAe,MAAf,GAAwB,CAA5B,EAA+B;AAC7B,cAAQ,MAAR,CAAe,GAAf,EAAoB,OAApB;AACD,KAFD,MAEO;AACL,cAAQ,IAAR,EAAc,QAAQ,MAAR,CAAe,GAAf,CAAd;AACD;AACF,GAnBD;AAoBD,CAvBD","file":"access.js","sourcesContent":["module.exports = function (options) {\r\n  const errorHandler = require('../errorHandler')(options)\r\n\r\n  return function (req, res, next) {\r\n    const handler = function (err, access) {\r\n      if (err) {\r\n        return errorHandler(req, res, next)(err)\r\n      }\r\n\r\n      if (['public', 'private', 'protected'].indexOf(access) < 0) {\r\n        throw new Error('Unsupported access, must be \"private\", \"protected\" or \"public\"')\r\n      }\r\n\r\n      req.access = access\r\n      next()\r\n    }\r\n\r\n    if (options.access.length > 1) {\r\n      options.access(req, handler)\r\n    } else {\r\n      handler(null, options.access(req))\r\n    }\r\n  }\r\n}\r\n"]}